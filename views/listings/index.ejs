<% layout("/layouts/boilerplate")-%>

    <body>
        <!-- <h3>All Listings</h3> -->
        <!-- <form action="/listings/add" method="get"><button>Create New Listing</button></form> -->

        <style>
            .tax-info{
                display: none;
            }
            .filters-container {
                display: flex;
                align-items: center;
                gap: 12px;
                border-bottom: 1px solid #eee;
            }

            #filters-wrapper {
                overflow-x: auto;
                flex: 1;
                scroll-behavior: smooth;
            }

            #filters-wrapper::-webkit-scrollbar {
                display: none;
            }

            #filters {
                display: flex;
                gap: 24px;
                padding: 12px 8px;
                white-space: nowrap;
            }

            .filter {
                display: flex;
                flex-direction: column;
                align-items: center;
                min-width: 70px;
                text-decoration: none;
                color: #222;
                opacity: 0.6;
            }

            .filter:hover {
                opacity: 1;
            }

            .filter i {
                font-size: 20px;
            }

            .filter p {
                font-size: 0.8rem;
                margin: 4px 0 0;
            }

            .scroll-btn {
                background: white;
                border: 1px solid #ddd;
                border-radius: 50%;
                width: 32px;
                height: 32px;
                cursor: pointer;
                box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
                flex-shrink: 0;
            }

            .tax-toggle {
                flex-shrink: 0;
                white-space: nowrap;
                border: 2px solid black;
                border-radius: 0.6rem;
                padding: 0.5rem;
                margin-left: 2rem;
            }
        </style>
        <div class="filters-container">

            <!-- LEFT ARROW -->
            <button class="scroll-btn" id="scrollLeft" aria-label="Scroll left">
                ‹
            </button>

            <!-- SCROLLABLE ICONS ONLY -->
            <div id="filters-wrapper">
                <div id="filters">

                    <a href="/listings" class="filter">
                        <i class="fa-solid fa-globe"></i>
                        <p>All</p>
                    </a>

                    <a href="/listings?category=Trending" class="filter">
                        <i class="fa-solid fa-fire"></i>
                        <p>Trending</p>
                    </a>

                    <a href="/listings?category=Rooms" class="filter">
                        <i class="fa-solid fa-bed"></i>
                        <p>Rooms</p>
                    </a>

                    <a href="/listings?category=Iconic%20Cities" class="filter">
                        <i class="fa-solid fa-mountain-city"></i>
                        <p>Iconic Cities</p>
                    </a>

                    <a href="/listings?category=Mountains" class="filter">
                        <i class="fa-solid fa-mountain"></i>
                        <p>Mountains</p>
                    </a>

                    <a href="/listings?category=Castles" class="filter">
                        <i class="fa-brands fa-fort-awesome"></i>
                        <p>Castles</p>
                    </a>

                    <a href="/listings?category=Amazing%20Pools" class="filter">
                        <i class="fa-solid fa-person-swimming"></i>
                        <p>Amazing Pools</p>
                    </a>

                    <a href="/listings?category=Camping" class="filter">
                        <i class="fa-solid fa-campground"></i>
                        <p>Camping</p>
                    </a>

                    <a href="/listings?category=Farms" class="filter">
                        <i class="fa-solid fa-cow"></i>
                        <p>Farms</p>
                    </a>

                    <a href="/listings?category=Arctic" class="filter">
                        <i class="fa-regular fa-snowflake"></i>
                        <p>Arctic</p>
                    </a>
                    <a href="/listings?category=Arctic" class="filter">
                        <i class="fa-solid fa-ship"></i>
                        <p>Boats</p>
                    </a>

                </div>
            </div>

            <!-- RIGHT ARROW -->
            <button class="scroll-btn" id="scrollRight" aria-label="Scroll right">
                ›
            </button>

            <!-- TAX TOGGLE (FIXED, NEVER SCROLLS) -->
            <div class="tax-toggle">
                <div class="form-check-reverse form-switch">
                    <input class="form-check-input" type="checkbox" id="switchCheckDefault">
                    <label class="form-check-label" for="switchCheckDefault">
                        Display Total After Taxes
                    </label>
                </div>
            </div>

        </div>


        <div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 mt-3">
            <%for(let list of allListings){%>
                <a class="link" href="/listings/<%=list._id%>">
                    <div class="card card-index listing-card">
                        <img src="<%=list.image.url%>" class="card-img-top" alt="<%=list.image.filename%>"
                            style="height: 20rem;">
                        <div class="card-img-overlay"></div>
                        <div class="card-body">
                            <b>
                                <p class="card-text">
                                    <%= list.title %>
                                </p>
                            </b>
                            <p class="card-text">&#8377;<%=list.price.toLocaleString("en-IN")%>
                            <i class="tax-info">&nbsp;&nbsp;+18% taxes</i></p>
                            
                        </div>
                    </div>
                </a>
                <%}%>

        </div>




        <!-- <ul>
            <%for(let list of allListings){%>
                <li><a href="/listings/<%=list._id%>">
                        <%= list.title %>
                    </a></li>
                <%}%>
        </ul> -->
    </body>

    <script>
        let taxSwitch = document.getElementById('switchCheckDefault');
        taxSwitch.addEventListener("click", () => {
            let taxInfo=document.getElementsByClassName('tax-info');
            for(info of taxInfo){
                if(info.style.display!='inline'){
                    info.style.display='inline';

                }
                else{
                    info.style.display='none';
                    
                }
            }
        })
    </script>
    <script>
        const wrapper = document.getElementById("filters-wrapper");
        const scrollLeftBtn = document.getElementById("scrollLeft");
        const scrollRightBtn = document.getElementById("scrollRight");

        const scrollAmount = 200;

        scrollLeftBtn.addEventListener("click", () => {
            wrapper.scrollBy({ left: -scrollAmount, behavior: "smooth" });
        });

        scrollRightBtn.addEventListener("click", () => {
            wrapper.scrollBy({ left: scrollAmount, behavior: "smooth" });
        });

        // Optional: hide buttons when not needed
        const updateButtons = () => {
            scrollLeftBtn.style.display = wrapper.scrollLeft > 0 ? "block" : "none";
            scrollRightBtn.style.display =
                wrapper.scrollLeft + wrapper.clientWidth < wrapper.scrollWidth
                    ? "block"
                    : "none";
        };

        // wrapper.addEventListener("scroll", updateButtons);
        // window.addEventListener("load", updateButtons);
    </script>